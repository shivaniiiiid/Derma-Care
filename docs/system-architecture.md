# Derma Care - System Architecture Documentation

## 📋 Table of Contents
1. [High-Level Architecture Overview](#high-level-architecture-overview)
2. [Frontend Architecture](#frontend-architecture)
3. [Backend Architecture](#backend-architecture)
4. [ML Pipeline Architecture](#ml-pipeline-architecture)
5. [Data Flow Diagrams](#data-flow-diagrams)
6. [Security Architecture](#security-architecture)
7. [Deployment Architecture](#deployment-architecture)

---

## 🏗️ High-Level Architecture Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            DERMA CARE SYSTEM ARCHITECTURE                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │   MOBILE APP    │    │   WEB APP       │    │   ADMIN PANEL   │        │
│  │                 │    │                 │    │                 │        │
│  │ • React Native  │    │ • React Native  │    │ • Web Dashboard │        │
│  │ • Expo Router   │    │ • Web Platform  │    │ • Analytics     │        │
│  │ • Offline Mode  │    │ • Real-time     │    │ • User Mgmt     │        │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│           │                       │                       │                │
│           └───────────────────────┼───────────────────────┘                │
│                                   │                                        │
│  ┌─────────────────────────────────┼─────────────────────────────────┐      │
│  │              API GATEWAY LAYER  │                                 │      │
│  │                                 │                                 │      │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │      │
│  │  │ RATE LIMIT  │  │   AUTH      │  │ LOAD BALANCE│              │      │
│  │  │ & SECURITY  │  │ MIDDLEWARE  │  │ & ROUTING   │              │      │
│  │  └─────────────┘  └─────────────┘  └─────────────┘              │      │
│  └─────────────────────────────────┼─────────────────────────────────┘      │
│                                   │                                        │
│  ┌─────────────────────────────────┼─────────────────────────────────┐      │
│  │           MICROSERVICES LAYER   │                                 │      │
│  │                                 │                                 │      │
│  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐  │      │
│  │ │ SKIN ANALYSIS│ │ INGREDIENT  │ │ WEATHER     │ │ USER MGMT   │  │      │
│  │ │ SERVICE     │ │ ANALYSIS    │ │ SERVICE     │ │ SERVICE     │  │      │
│  │ │             │ │ SERVICE     │ │             │ │             │  │      │
│  │ │ • ML Models │ │ • CSV Check │ │ • UV Index  │ │ • Auth      │  │      │
│  │ │ • TF Serving│ │ • Safety    │ │ • Alerts    │ │ • Profile   │  │      │
│  │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘  │      │
│  └─────────────────────────────────┼─────────────────────────────────┘      │
│                                   │                                        │
│  ┌─────────────────────────────────┼─────────────────────────────────┐      │
│  │               DATA LAYER        │                                 │      │
│  │                                 │                                 │      │
│  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐  │      │
│  │ │ SUPABASE    │ │ FILE        │ │ ML MODEL    │ │ CACHE       │  │      │
│  │ │ DATABASE    │ │ STORAGE     │ │ STORAGE     │ │ (REDIS)     │  │      │
│  │ │             │ │             │ │             │ │             │  │      │
│  │ │ • User Data │ │ • Images    │ │ • TF Models │ │ • Sessions  │  │      │
│  │ │ • History   │ │ • Reports   │ │ • Weights   │ │ • Results   │  │      │
│  │ │ • Analytics │ │ • Backups   │ │ • Configs   │ │ • API Cache │  │      │
│  │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘  │      │
│  └─────────────────────────────────────────────────────────────────────┘      │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐      │
│  │                       EXTERNAL SERVICES                            │      │
│  │                                                                     │      │
│  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐  │      │
│  │ │OPENWEATHER  │ │   FIREBASE  │ │   TWILIO    │ │   STRIPE    │  │      │
│  │ │    API      │ │    AUTH     │ │    SMS      │ │  PAYMENTS   │  │      │
│  │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘  │      │
│  └─────────────────────────────────────────────────────────────────────┘      │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 📱 Frontend Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         REACT NATIVE FRONTEND ARCHITECTURE                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        PRESENTATION LAYER                           │    │
│  │                                                                     │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │    │
│  │  │   TAB SCREENS   │  │  MODAL SCREENS  │  │   COMPONENTS    │    │    │
│  │  │                 │  │                 │  │                 │    │    │
│  │  │ • Home/Scan     │  │ • Onboarding    │  │ • FeatureCard   │    │    │
│  │  │ • Ingredients   │  │ • Results       │  │ • ModeToggle    │    │    │
│  │  │ • UV Care       │  │ • Profile Setup │  │ • LoadingSpinner│    │    │
│  │  │ • History       │  │ • Settings      │  │ • ProgressChart │    │    │
│  │  │ • Profile       │  │                 │  │ • AnalysisCard  │    │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                      │                                      │
│  ┌─────────────────────────────────────┼─────────────────────────────────┐  │
│  │                   BUSINESS LOGIC LAYER                                │  │
│  │                                     │                                 │  │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐      │  │
│  │  │   CUSTOM HOOKS  │  │   CONTEXT API   │  │   UTILITIES     │      │  │
│  │  │                 │  │                 │  │                 │      │  │
│  │  │ • useApp        │  │ • AppContext    │  │ • Validation    │      │  │
│  │  │ • useTTS        │  │ • AuthContext   │  │ • Formatting    │      │  │
│  │  │ • useCamera     │  │ • MLContext     │  │ • Encryption    │      │  │
│  │  │ • useLocation   │  │                 │  │ • AsyncStorage  │      │  │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘      │  │
│  └─────────────────────────────────────┼─────────────────────────────────┘  │
│                                       │                                    │
│  ┌─────────────────────────────────────┼─────────────────────────────────┐  │
│  │                    SERVICE LAYER    │                                 │  │
│  │                                     │                                 │  │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐      │  │
│  │  │   API SERVICES  │  │  ML SERVICES    │  │  DATA SERVICES  │      │  │
│  │  │                 │  │                 │  │                 │      │  │
│  │  │ • skinAnalysis  │  │ • TFLite Models │  │ • Local Storage │      │  │
│  │  │ • ingredients   │  │ • Image Proc    │  │ • Cache Mgmt    │      │  │
│  │  │ • weatherAPI    │  │ • Classification│  │ • Sync Service  │      │  │
│  │  │ • userAPI       │  │ • Segmentation  │  │ • Backup        │      │  │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘      │  │
│  └─────────────────────────────────────┼─────────────────────────────────┘  │
│                                       │                                    │
│  ┌─────────────────────────────────────┼─────────────────────────────────┐  │
│  │                 PLATFORM LAYER      │                                 │  │
│  │                                     │                                 │  │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐      │  │
│  │  │ REACT NATIVE    │  │  EXPO MODULES   │  │  NATIVE MODULES │      │  │
│  │  │                 │  │                 │  │                 │      │  │
│  │  │ • Navigation    │  │ • Camera        │  │ • TensorFlow    │      │  │
│  │  │ • Gestures      │  │ • Image Picker  │  │ • File System   │      │  │
│  │  │ • Animations    │  │ • Location      │  │ • Biometrics    │      │  │
│  │  │ • Styling       │  │ • Notifications │  │ • Crypto        │      │  │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘      │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔧 Backend Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           BACKEND SYSTEM ARCHITECTURE                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                          API GATEWAY                                │    │
│  │                                                                     │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐│    │
│  │  │ RATE LIMIT  │  │    AUTH     │  │   CORS      │  │   LOGGING   ││    │
│  │  │ & THROTTLE  │  │ VALIDATION  │  │ & SECURITY  │  │ & MONITOR   ││    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘│    │
│  └─────────────────────────────────┼───────────────────────────────────┘    │
│                                   │                                        │
│  ┌─────────────────────────────────┼─────────────────────────────────┐      │
│  │               MICROSERVICES     │                                 │      │
│  │                                 │                                 │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │            SKIN ANALYSIS SERVICE                            │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │ IMAGE PROC  │  │ ML INFERENCE│  │  HEATMAP    │        │  │      │
│  │  │  │             │  │             │  │ GENERATION  │        │  │      │
│  │  │  │ • Resize    │  │ • TF Serving│  │             │        │  │      │
│  │  │  │ • Normalize │  │ • Batch Proc│  │ • Grad-CAM  │        │  │      │
│  │  │  │ • Augment   │  │ • GPU Accel │  │ • Overlay   │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  │                                                                   │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │          INGREDIENT ANALYSIS SERVICE                        │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │ TEXT PARSER │  │ CSV LOOKUP  │  │ SAFETY SCORE│        │  │      │
│  │  │  │             │  │             │  │ CALCULATOR  │        │  │      │
│  │  │  │ • NLP Clean │  │ • Reference │  │             │        │  │      │
│  │  │  │ • Extract   │  │ • Match Algo│  │ • Risk Calc │        │  │      │
│  │  │  │ • Normalize │  │ • Fuzzy Srch│  │ • Category  │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  │                                                                   │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │             WEATHER SERVICE                                 │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │ GEO LOCATION│  │ API CLIENT  │  │ UV CALCULATOR│       │  │      │
│  │  │  │             │  │             │  │             │        │  │      │
│  │  │  │ • GPS Parse │  │ • OpenWeath │  │ • Index Calc│        │  │      │
│  │  │  │ • Geocoding │  │ • Rate Limit│  │ • Recommends│        │  │      │
│  │  │  │ • Caching   │  │ • Fallbacks │  │ • Alerts    │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  │                                                                   │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │            USER MANAGEMENT SERVICE                          │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │    AUTH     │  │   PROFILE   │  │   HISTORY   │        │  │      │
│  │  │  │             │  │             │  │             │        │  │      │
│  │  │  │ • JWT Token │  │ • CRUD Ops  │  │ • Tracking  │        │  │      │
│  │  │  │ • OAuth     │  │ • Validation│  │ • Analytics │        │  │      │
│  │  │  │ • Sessions  │  │ • Encryption│  │ • Export    │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  └─────────────────────────────────────┼─────────────────────────────────┘  │
│                                       │                                    │
│  ┌─────────────────────────────────────┼─────────────────────────────────┐  │
│  │                  DATA LAYER         │                                 │  │
│  │                                     │                                 │  │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐      │  │
│  │  │   SUPABASE      │  │  FILE STORAGE   │  │   CACHE LAYER   │      │  │
│  │  │   DATABASE      │  │                 │  │                 │      │  │
│  │  │                 │  │ • Images        │  │ • Redis         │      │  │
│  │  │ • Users         │  │ • Reports       │  │ • Sessions      │      │  │
│  │  │ • Profiles      │  │ • ML Models     │  │ • API Cache     │      │  │
│  │  │ • History       │  │ • Backups       │  │ • Results       │      │  │
│  │  │ • Analytics     │  │ • Logs          │  │ • Temp Data     │      │  │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘      │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🧠 ML Pipeline Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        MACHINE LEARNING PIPELINE                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        TRAINING PIPELINE                            │    │
│  │                                                                     │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐│    │
│  │  │  DATASET    │  │ PREPROCESS  │  │   TRAIN     │  │   DEPLOY    ││    │
│  │  │             │  │             │  │             │  │             ││    │
│  │  │ • ISIC 2019 │─→│ • Resize    │─→│ • ResNet50  │─→│ • TFLite    ││    │
│  │  │ • DermNet   │  │ • Normalize │  │ • EfficNet  │  │ • Quantize  ││    │
│  │  │ • HAM10000  │  │ • Augment   │  │ • U-Net     │  │ • Optimize  ││    │
│  │  │ • Custom    │  │ • Balance   │  │ • Custom    │  │ • Test      ││    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘│    │
│  └─────────────────────────────────┼───────────────────────────────────┘    │
│                                   │                                        │
│  ┌─────────────────────────────────┼─────────────────────────────────┐      │
│  │                INFERENCE PIPELINE                                  │      │
│  │                                 │                                 │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │               CLASSIFICATION MODEL                          │  │      │
│  │  │                                                             │  │      │
│  │  │  INPUT: [224x224x3] → PREPROCESSING → RESNET50 → SOFTMAX   │  │      │
│  │  │                                                             │  │      │
│  │  │  OUTPUT: [                                                  │  │      │
│  │  │    { class: "Acne", probability: 0.85 }                    │  │      │
│  │  │    { class: "Eczema", probability: 0.12 }                  │  │      │
│  │  │    { class: "Normal", probability: 0.03 }                  │  │      │
│  │  │  ]                                                          │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  │                                                                   │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │              SEGMENTATION MODEL                             │  │      │
│  │  │                                                             │  │      │
│  │  │  INPUT: [256x256x3] → ENCODER → BOTTLENECK → DECODER       │  │      │
│  │  │                      (ResNet)      |         (Upsampling)  │  │      │
│  │  │                                   U-NET                    │  │      │
│  │  │                                                             │  │      │
│  │  │  OUTPUT: [256x256x1] Binary Mask                          │  │      │
│  │  │    - 1: Affected Area                                      │  │      │
│  │  │    - 0: Normal Skin                                        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  │                                                                   │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │            EXPLAINABILITY (GRAD-CAM)                       │  │      │
│  │  │                                                             │  │      │
│  │  │  CLASSIFICATION MODEL → GRAD-CAM → HEATMAP OVERLAY         │  │      │
│  │  │                                                             │  │      │
│  │  │  PROCESS:                                                   │  │      │
│  │  │    1. Get feature maps from last conv layer                │  │      │
│  │  │    2. Compute gradients w.r.t predicted class              │  │      │
│  │  │    3. Generate weighted activation map                      │  │      │
│  │  │    4. Overlay heatmap on original image                    │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  └─────────────────────────────────────┼─────────────────────────────────┘  │
│                                       │                                    │
│  ┌─────────────────────────────────────┼─────────────────────────────────┐  │
│  │                MODEL SERVING        │                                 │  │
│  │                                     │                                 │  │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐      │  │
│  │  │   TF SERVING    │  │   TF LITE       │  │   ONNX RUNTIME  │      │  │
│  │  │                 │  │                 │  │                 │      │  │
│  │  │ • Cloud Deploy  │  │ • Mobile Deploy │  │ • Cross Platform│      │  │
│  │  │ • GPU Support   │  │ • CPU Optimized │  │ • Edge Deploy   │      │  │
│  │  │ • Batch Process │  │ • Low Latency   │  │ • Multiple      │      │  │
│  │  │ • Auto Scale    │  │ • Offline Mode  │  │   Frameworks    │      │  │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘      │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        MODEL REGISTRY                               │    │
│  │                                                                     │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐│    │
│  │  │ VERSIONING  │  │ METADATA    │  │ EXPERIMENTS │  │ DEPLOYMENT  ││    │
│  │  │             │  │             │  │             │  │             ││    │
│  │  │ • Git-like  │  │ • Metrics   │  │ • A/B Test  │  │ • Blue-Green││    │
│  │  │ • Rollback  │  │ • Params    │  │ • Champion  │  │ • Canary    ││    │
│  │  │ • Branches  │  │ • Artifacts │  │ • Challenger│  │ • Rollback  ││    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘│    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 Data Flow Diagrams

### 1. Skin Analysis Flow
```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          SKIN ANALYSIS DATA FLOW                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  USER ACTION: Take Photo / Upload Image                                    │
│      │                                                                     │
│      ▼                                                                     │
│  ┌─────────────────┐                                                       │
│  │  MOBILE APP     │                                                       │
│  │                 │                                                       │
│  │  1. Capture     │                                                       │
│  │  2. Validate    │                                                       │
│  │  3. Compress    │                                                       │
│  │  4. Preview     │                                                       │
│  └─────────────────┘                                                       │
│      │                                                                     │
│      ▼                                                                     │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │  IMAGE SERVICE  │────▶│  ML INFERENCE   │────▶│  RESULT SERVICE │     │
│  │                 │     │                 │     │                 │     │
│  │  • Preprocess   │     │  • Classification│     │  • Format       │     │
│  │  • Resize       │     │  • Segmentation │     │  • Validate     │     │
│  │  • Normalize    │     │  • Grad-CAM     │     │  • Enrich       │     │
│  │  • Augment      │     │  • Confidence   │     │  • Store        │     │
│  └─────────────────┘     └─────────────────┘     └─────────────────┘     │
│      │                       │                       │                   │
│      ▼                       ▼                       ▼                   │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │  FILE STORAGE   │     │  MODEL REGISTRY │     │   DATABASE      │     │
│  │                 │     │                 │     │                 │     │
│  │  • Original     │     │  • TFLite       │     │  • Results      │     │
│  │  • Processed    │     │  • Metadata     │     │  • History      │     │
│  │  • Heatmaps     │     │  • Versions     │     │  • Analytics    │     │
│  └─────────────────┘     └─────────────────┘     └─────────────────┘     │
│      │                                               │                   │
│      ▼                                               ▼                   │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                    RESPONSE TO USER                                 │  │
│  │                                                                     │  │
│  │  SIMPLE MODE:                    DETAILED MODE:                     │  │
│  │  • "Looks like Acne"            • Medical Name                      │  │
│  │  • "See Doctor" Icon            • Confidence: 85%                   │  │
│  │  • Audio: "You have acne"       • Grad-CAM Heatmap                  │  │
│  │                                  • Affected Area: 12%               │  │
│  │                                  • Recommendation Details           │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2. Ingredient Analysis Flow
```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       INGREDIENT ANALYSIS DATA FLOW                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  USER ACTION: Input/Paste Ingredients List                                 │
│      │                                                                     │
│      ▼                                                                     │
│  ┌─────────────────┐                                                       │
│  │   TEXT PARSER   │                                                       │
│  │                 │                                                       │
│  │  1. Clean Text  │                                                       │
│  │  2. Extract     │                                                       │
│  │  3. Normalize   │                                                       │
│  │  4. Tokenize    │                                                       │
│  └─────────────────┘                                                       │
│      │                                                                     │
│      ▼                                                                     │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │  LOOKUP ENGINE  │────▶│  SAFETY CALC    │────▶│ REPORT GEN      │     │
│  │                 │     │                 │     │                 │     │
│  │  • CSV Search   │     │  • Risk Score   │     │  • Categorize   │     │
│  │  • Fuzzy Match  │     │  • Severity     │     │  • Recommend    │     │
│  │  • Synonyms     │     │  • Interactions │     │  • Alternatives │     │
│  │  • Validate     │     │  • Profile      │     │  • Summary      │     │
│  └─────────────────┘     └─────────────────┘     └─────────────────┘     │
│      │                       │                       │                   │
│      ▼                       ▼                       ▼                   │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │ INGREDIENT DB   │     │  RULES ENGINE   │     │   CACHE         │     │
│  │                 │     │                 │     │                 │     │
│  │  • Reference    │     │  • Safety Rules │     │  • Results      │     │
│  │  • Properties   │     │  • Skin Types   │     │  • Lookups      │     │
│  │  • Categories   │     │  • Allergies    │     │  • Sessions     │     │
│  └─────────────────┘     └─────────────────┘     └─────────────────┘     │
│      │                                               │                   │
│      ▼                                               ▼                   │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                    RESPONSE TO USER                                 │  │
│  │                                                                     │  │
│  │  SIMPLE MODE:                    DETAILED MODE:                     │  │
│  │  • "Safe Product ✅"            • Per-ingredient breakdown           │  │
│  │  • "Harmful Ingredients ❌"     • Safety rationale                   │  │
│  │  • Audio Summary                • Chemical interactions             │  │
│  │                                 • Alternatives suggested            │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔐 Security Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           SECURITY ARCHITECTURE                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      FRONTEND SECURITY                              │    │
│  │                                                                     │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐│    │
│  │  │   INPUT     │  │  STORAGE    │  │   NETWORK   │  │ BIOMETRIC   ││    │
│  │  │ VALIDATION  │  │ ENCRYPTION  │  │ SECURITY    │  │   AUTH      ││    │
│  │  │             │  │             │  │             │  │             ││    │
│  │  │ • Sanitize  │  │ • AES-256   │  │ • TLS 1.3   │  │ • Touch ID  ││    │
│  │  │ • Validate  │  │ • Key Chain │  │ • Cert Pin  │  │ • Face ID   ││    │
│  │  │ • Length    │  │ • Secure    │  │ • HSTS      │  │ • PIN       ││    │
│  │  │ • Type      │  │   Storage   │  │ • CSP       │  │ • Pattern   ││    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘│    │
│  └─────────────────────────────────┼───────────────────────────────────┘    │
│                                   │                                        │
│  ┌─────────────────────────────────┼─────────────────────────────────┐      │
│  │                    API SECURITY │                                 │      │
│  │                                 │                                 │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │                  API GATEWAY                                │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │    AUTH     │  │ RATE LIMIT  │  │    CORS     │        │  │      │
│  │  │  │             │  │             │  │             │        │  │      │
│  │  │  │ • JWT       │  │ • Per User  │  │ • Origins   │        │  │      │
│  │  │  │ • OAuth2    │  │ • Per IP    │  │ • Methods   │        │  │      │
│  │  │  │ • API Keys  │  │ • Per Route │  │ • Headers   │        │  │      │
│  │  │  │ • Refresh   │  │ • Sliding   │  │ • Preflight │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │ ENCRYPTION  │  │ MONITORING  │  │ FIREWALL    │        │  │      │
│  │  │  │             │  │             │  │             │        │  │      │
│  │  │  │ • E2E       │  │ • Intrusion │  │ • WAF       │        │  │      │
│  │  │  │ • At Rest   │  │ • Anomaly   │  │ • DDoS      │        │  │      │
│  │  │  │ • In Transit│  │ • Audit Log │  │ • Geo Block │        │  │      │
│  │  │  │ • Key Mgmt  │  │ • Alerts    │  │ • IP Filter │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  └─────────────────────────────────────┼─────────────────────────────────┘  │
│                                       │                                    │
│  ┌─────────────────────────────────────┼─────────────────────────────────┐  │
│  │                 DATA SECURITY       │                                 │  │
│  │                                     │                                 │  │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐      │  │
│  │  │   DATABASE      │  │  FILE STORAGE   │  │    BACKUP       │      │  │
│  │  │   SECURITY      │  │    SECURITY     │  │    SECURITY     │      │  │
│  │  │                 │  │                 │  │                 │      │  │
│  │  │ • RLS Policies  │  │ • Signed URLs   │  │ • Encryption    │      │  │
│  │  │ • Row Security  │  │ • Access Control│  │ • Versioning    │      │  │
│  │  │ • Field Encrypt │  │ • Virus Scan    │  │ • Retention     │      │  │
│  │  │ • Audit Trail   │  │ • Size Limits   │  │ • Geographic    │      │  │
│  │  │ • Connection    │  │ • Type Filter   │  │ • Point in Time │      │  │
│  │  │   Pooling       │  │ • Metadata      │  │ • Disaster      │      │  │
│  │  │                 │  │   Strip         │  │   Recovery      │      │  │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘      │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                     COMPLIANCE & PRIVACY                           │    │
│  │                                                                     │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐│    │
│  │  │    GDPR     │  │    HIPAA    │  │    CCPA     │  │   MEDICAL   ││    │
│  │  │ COMPLIANCE  │  │ COMPLIANCE  │  │ COMPLIANCE  │  │ DEVICE REG  ││    │
│  │  │             │  │             │  │             │  │             ││    │
│  │  │ • Consent   │  │ • PHI       │  │ • Consumer  │  │ • FDA Class ││    │
│  │  │ • Right to  │  │ • Access    │  │   Rights    │  │ • CE Mark   ││    │
│  │  │   Erasure   │  │ • Audit     │  │ • Do Not    │  │ • ISO 13485 ││    │
│  │  │ • Data Port │  │ • Encrypt   │  │   Sell      │  │ • Risk Mgmt ││    │
│  │  │ • Breach    │  │ • Minimum   │  │ • Opt Out   │  │ • Clinical  ││    │
│  │  │   Notify    │  │   Necessary │  │             │  │   Evidence  ││    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘│    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🚀 Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          DEPLOYMENT ARCHITECTURE                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      MOBILE DEPLOYMENT                              │    │
│  │                                                                     │    │
│  │  ┌─────────────────┐              ┌─────────────────┐              │    │
│  │  │   iOS DEPLOY    │              │  ANDROID DEPLOY │              │    │
│  │  │                 │              │                 │              │    │
│  │  │ ┌─────────────┐ │              │ ┌─────────────┐ │              │    │
│  │  │ │ APP STORE   │ │              │ │ PLAY STORE  │ │              │    │
│  │  │ │             │ │              │ │             │ │              │    │
│  │  │ • TestFlight│ │              │ • Internal  │ │              │    │
│  │  │ • Review    │ │              │ • Alpha     │ │              │    │
│  │  │ • Release   │ │              │ • Beta      │ │              │    │
│  │  │ • Update    │ │              │ • Production│ │              │    │
│  │  │ └─────────────┘ │              │ └─────────────┘ │              │    │
│  │  │                 │              │                 │              │    │
│  │  │ ┌─────────────┐ │              │ ┌─────────────┐ │              │    │
│  │  │ │ ENTERPRISE  │ │              │ │   DIRECT    │ │              │    │
│  │  │ │             │ │              │ │   INSTALL   │ │              │    │
│  │  │ • MDM       │ │              │ • APK       │ │              │    │
│  │  │ • Corporate │ │              │ • Sideload  │ │              │    │
│  │  │ • B2B       │ │              │ • Enterprise│ │              │    │
│  │  │ └─────────────┘ │              │ └─────────────┘ │              │    │
│  │  └─────────────────┘              └─────────────────┘              │    │
│  └─────────────────────────────────┼───────────────────────────────────┘    │
│                                   │                                        │
│  ┌─────────────────────────────────┼─────────────────────────────────┐      │
│  │                  CLOUD DEPLOYMENT                                  │      │
│  │                                 │                                 │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │              PRODUCTION ENVIRONMENT                         │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │     CDN     │  │ LOAD BALANCER│  │    WAF      │        │  │      │
│  │  │  │             │  │             │  │             │        │  │      │
│  │  │  │ • Global    │  │ • Auto Scale│  │ • DDoS Prot │        │  │      │
│  │  │  │ • Cache     │  │ • Health    │  │ • Rate Limit│        │  │      │
│  │  │  │ • Edge      │  │ • Failover  │  │ • Geo Block │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │ APP SERVERS │  │   DATABASE  │  │ ML SERVING  │        │  │      │
│  │  │  │             │  │             │  │             │        │  │      │
│  │  │  │ • Docker    │  │ • Supabase  │  │ • TF Serving│        │  │      │
│  │  │  │ • K8s       │  │ • Read Rep  │  │ • GPU Nodes │        │  │      │
│  │  │  │ • Auto Scale│  │ • Backup    │  │ • Model Reg │        │  │      │
│  │  │  │ • Blue/Green│  │ • HA Setup  │  │ • A/B Test  │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  │                                                                   │      │
│  │  ┌─────────────────────────────────────────────────────────────┐  │      │
│  │  │             STAGING ENVIRONMENT                             │  │      │
│  │  │                                                             │  │      │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │      │
│  │  │  │   TESTING   │  │   PREVIEW   │  │ INTEGRATION │        │  │      │
│  │  │  │             │  │             │  │             │        │  │      │
│  │  │  │ • Unit Test │  │ • Feature   │  │ • E2E Tests │        │  │      │
│  │  │  │ • API Test  │  │ • UAT       │  │ • Load Test │        │  │      │
│  │  │  │ • ML Test   │  │ • Demo      │  │ • Security  │        │  │      │
│  │  │  │ • Security  │  │ • Feedback  │  │ • Perf Test │        │  │      │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │      │
│  │  └─────────────────────────────────────────────────────────────┘  │      │
│  └─────────────────────────────────────┼─────────────────────────────────┘  │
│                                       │                                    │
│  ┌─────────────────────────────────────┼─────────────────────────────────┐  │
│  │               CI/CD PIPELINE        │                                 │  │
│  │                                     │                                 │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐  │  │
│  │  │                    BUILD PIPELINE                               │  │  │
│  │  │                                                                 │  │  │
│  │  │  GIT PUSH → BUILD → TEST → SECURITY → DEPLOY → MONITOR        │  │  │
│  │  │      │        │      │       │         │        │              │  │  │
│  │  │      ▼        ▼      ▼       ▼         ▼        ▼              │  │  │
│  │  │  ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐         │  │  │
│  │  │  │Code │  │Expo │  │Jest │  │SAST │  │K8s  │  │APM  │         │  │  │
│  │  │  │Qual │  │Build│  │Test │  │Scan │  │Roll │  │Log  │         │  │  │
│  │  │  │Gate │  │     │  │     │  │     │  │out  │  │     │         │  │  │
│  │  │  └─────┘  └─────┘  └─────┘  └─────┘  └─────┘  └─────┘         │  │  │
│  │  └─────────────────────────────────────────────────────────────────┘  │  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐  │  │
│  │  │                  DEPLOYMENT STRATEGIES                          │  │  │
│  │  │                                                                 │  │  │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐            │  │  │
│  │  │  │ BLUE-GREEN  │  │   CANARY    │  │  ROLLING    │            │  │  │
│  │  │  │             │  │             │  │             │            │  │  │
│  │  │  │ • Zero Down │  │ • Gradual   │  │ • Progressive│            │  │  │
│  │  │  │ • Quick     │  │ • Monitor   │  │ • Health    │            │  │  │
│  │  │  │   Rollback  │  │ • A/B Test  │  │   Checks    │            │  │  │
│  │  │  │ • Full Swap │  │ • Risk Red  │  │ • Auto Scale│            │  │  │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘            │  │  │
│  │  └─────────────────────────────────────────────────────────────────┘  │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔧 Technology Stack Summary

### Frontend Stack
- **Framework**: React Native with Expo
- **Navigation**: Expo Router
- **State Management**: React Context + Custom Hooks
- **UI Components**: React Native Paper + Custom Components
- **Styling**: StyleSheet + Theme System
- **Animations**: React Native Reanimated
- **Image Processing**: Expo Image + TensorFlow.js

### Backend Stack
- **Database**: Supabase (PostgreSQL)
- **Authentication**: Supabase Auth
- **File Storage**: Supabase Storage
- **API**: Supabase Edge Functions
- **Real-time**: Supabase Realtime
- **Cache**: Redis (if needed)

### ML Stack
- **Training**: TensorFlow/Keras (Python)
- **Serving**: TensorFlow Lite (Mobile)
- **Models**: ResNet50, EfficientNet, U-Net
- **Explainability**: Grad-CAM
- **Deployment**: TensorFlow Serving

### External Services
- **Weather**: OpenWeatherMap API
- **Text-to-Speech**: Expo Speech
- **Analytics**: Supabase Analytics
- **Monitoring**: Sentry (optional)

### Development Tools
- **Version Control**: Git
- **CI/CD**: GitHub Actions
- **Testing**: Jest + Detox
- **Code Quality**: ESLint + Prettier
- **Documentation**: Markdown + Diagrams

---

## 📊 Performance Metrics

### Response Time Targets
- **Skin Analysis**: < 3 seconds
- **Ingredient Lookup**: < 1 second
- **UV Data Fetch**: < 2 seconds
- **App Launch**: < 2 seconds
- **Navigation**: < 500ms

### Scalability Targets
- **Concurrent Users**: 10,000+
- **Daily Analyses**: 100,000+
- **Image Storage**: 1TB+
- **Database Queries**: 1M+/day

### Availability Targets
- **Uptime**: 99.9%
- **Recovery Time**: < 4 hours
- **Backup Frequency**: Daily
- **Data Retention**: 7 years

---

This comprehensive architecture ensures **Derma Care** is scalable, secure, and maintainable while providing excellent user experience for both naive and educated users.